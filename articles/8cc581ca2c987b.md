---
title: "（Cloudflare Pages）GitHubリポジトリを連携しているとブランチを削除してもPreview Deploymentが残り続ける"
emoji: "✨"
type: "tech"
topics: ["Cloudflare Pages"]
published: true
---
## 結論

GitHubリポジトリを指定してCloudflare Pagesを作成する場合の話です。リポジトリの運用次第では問題が生じるかもしれません。

1. メインではないブランチを作成するとPreview Deploymentとしてデプロイされます。プレビュー用のURLが発行されて`https://ブランチ名.プロジェクト名.pages.dev`でアクセスできます。
2. ブランチを削除しても、そのブランチに対応するPreview Deploymentは残り続けます。これは仕様です。
3. Cloudflareのダッシュボード画面からAll deployments→Manage deployment→Deleteを実行すると、一覧からは法事が消えます。しかし、Preview Deploymentが残り続けます。プレビューURLもアクセス可能なまま残り続けます。

## Preview Deployment機能のおさらい

Cloudflare PagesにはProduction環境とPreview環境が用意されています。

- GitHubリポジトリを連携している場合、メインのブランチではないブランチにpushされると自動的にPreview Deploymentが作成されます。
- CLIの場合、`wrangler pages deploy ディレクトリ名 --branch ブランチ名`コマンドを実行するとPreview Deploymentが作成されます。

記事の冒頭で説明した事象が発生するのはGitHubリポジトリを連携している場合のみです。CLIからデプロイしたPreview Deploymentは期待通り削除できます。プレビューURLは404 Not Foundが返されます。

## 参考資料

1. [How to Delete Aliased Preview Deployments? - Developers / Cloudflare Pages - Cloudflare Community](https://community.cloudflare.com/t/how-to-delete-aliased-preview-deployments/269292/25)
