---
title: "ï¼ˆSwiftï¼‰MLImageClassifierã‚’ç”¨ã„ã¦iPhoneä¸Šã§ç”»åƒåˆ†é¡ãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´ã¨æ¨è«–ã‚’è¡Œã†"
emoji: "ğŸ“"
type: "tech"
topics: [Apple, iOS, Swift, æ©Ÿæ¢°å­¦ç¿’]
published: false
---
## ã¯ã˜ã‚ã«

Create MLã®MLImageClassifierã‚’ç”¨ã„ã¦iPhoneä¸Šã§ç”»åƒåˆ†é¡ãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´ã¨æ¨è«–è¡Œã†ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã—ãŸã€‚å…·ä½“çš„ãªå®Ÿè£…ã ã‘çŸ¥ã‚ŠãŸã„å ´åˆã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚`Logic/ImageTrainer.swift`ãŒè¨“ç·´ã€`Logic/ImageClassifier.swift`ãŒæ¨è«–ã®å®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚

https://github.com/moutend/TrainingMLImageClassifier

Macä¸Šã§ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¦`.mlmodel`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åŸ‹ã‚è¾¼ã‚€ä¾‹ã¯ã‚ˆãè¦‹ã‹ã‘ã¾ã™ãŒã€ãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´ã‹ã‚‰æ¨è«–ã¾ã§ã‚’iPhoneä¸Šã§å®Œçµã•ã›ã‚‹ä¾‹ã¯ã‚ã¾ã‚Šè¦‹ã‹ã‘ã¾ã›ã‚“ã€‚ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹ãªæ©Ÿæ¢°å­¦ç¿’ã®ä¸€ä¾‹ã¨ã—ã¦å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

## ã“ã®è¨˜äº‹ã§æ·±å €ã™ã‚‹å†…å®¹

ã“ã“ã‹ã‚‰ã¯å®Ÿè£…ã®è©³ç´°ã‚’æ·±æ˜ã‚Šã—ã¾ã™ã€‚

1. å®Ÿè³ªçš„ã«ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ãƒ¢ãƒ‡ãƒ«ã—ã‹é¸æŠè‚¢ãŒã‚ã‚Šã¾ã›ã‚“ã€‚

### ï¼ˆãã®1ï¼‰å®Ÿè³ªçš„ã«ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ãƒ¢ãƒ‡ãƒ«ã—ã‹é¸æŠè‚¢ãŒãªã„

ãƒ‡ã‚£ãƒ¼ãƒ—ãªãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§æœ€å¼·ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½œã‚ã†ã¨ãŠè€ƒãˆã®æ–¹ã«ã¯æ‚²å ±ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ç¾çŠ¶ã€Create MLã§ç”»åƒåˆ†é¡ã«åˆ©ç”¨ã§ãã‚‹ã®ã¯å®Ÿè³ªçš„ã«ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ãƒ¢ãƒ‡ãƒ«ã®ã¿ã§ã™ã€‚ä»¥ä¸‹ã€Apple Developerãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰å¼•ç”¨ã—ã¾ã™ã€‚

> [MLImageClassifier.ModelParameters.ClassifierType - Apple Developer Documentation](https://developer.apple.com/documentation/createml/mlimageclassifier/modelparameters-swift.struct/classifiertype)
> 
> `case logisticRegressor` -- Logistic regression is a statistical model that classifies input feature vector into different categories.
> `case multilayerPerceptron(layerSizes: [Int])` -- Multilayer perceptron, layerSizes holds a list of positive integers that represent the number of hidden units in each layer. An additional fully connected layer with a Softmax activation output will be added that maps to probabilities of sound categories.

2ã¤ã‚ã®`multilayerPerceptron`ãŒãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’åˆ©ç”¨ã—ãŸãƒ¢ãƒ‡ãƒ«ã‹ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å®Ÿéš›ãã†ã‚‰ã—ã„ã®ã§ã™ãŒã€èª¬æ˜ã‚’æœ€å¾Œã¾ã§èª­ã‚€ã¨éŸ³å£°ã‚’åˆ†é¡ã™ã‚‹ãŸã‚ã€ã¨æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚

ã¤ã¾ã‚Šã€ä¾‹ãˆã°ç”»åƒå‡¦ç†ã§ã‚ˆãä½¿ã‚ã‚Œã‚‹ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã§ã¯ãªãã€æ–‡å­—é€šã‚Šãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’é‡ã­ãŸã ã‘ã®ç´ æœ´ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ä½•ã«ã§ã‚‚ä½¿ãˆã‚‹ã®ã§ã€ã¨ã‚Šã‚ãˆãšé¸æŠè‚¢ã¨ã—ã¦å«ã‚ã¦ã‚ã‚‹ã ã‘ã¨æ€ã‚ã‚Œã¾ã™ã€‚

ä½™è«‡ã«ãªã‚Šã¾ã™ãŒã€æ›¸ç±ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã€ã§ã¯ç´ æœ´ãª2å±¤ã®ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ã¦MNISTç”»åƒã®åˆ†é¡æ°—ã‚’å®Ÿè£…ã™ã‚‹ä¾‹ãŒç™»å ´ã—ã¾ã™ã€‚

- [O'Reilly Japan - ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learning](https://www.oreilly.co.jp/books/9784873117584/)

## å‚è€ƒè³‡æ–™

1. [MLJob - Apple Developer Documentation](https://developer.apple.com/documentation/createml/mljob)
2. [MLImageClassifier.ModelParameters - Apple Developer Documentation](https://developer.apple.com/documentation/createml/mlimageclassifier/modelparameters-swift.struct)
3. [MLImageClassifier.FeatureExtractorType - Apple Developer Documentation](https://developer.apple.com/documentation/createml/mlimageclassifier/featureextractortype)
4. [MLImageClassifier.ModelParameters.ModelAlgorithmType - Apple Developer Documentation](https://developer.apple.com/documentation/createml/mlimageclassifier/modelparameters-swift.struct/modelalgorithmtype)
5. [iOSã§ã®CreateML / CoreMLã‚’ç”¨ã„ãŸã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹æ©Ÿæ¢°å­¦ç¿’ - ã‚¨ãƒ‹ã‚°ãƒ¢é–‹ç™ºè€…ãƒ–ãƒ­ã‚°](https://tech.enigmo.co.jp/entry/2022/12/20/070000)
