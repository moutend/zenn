---
title: "拡散モデルの理論と症状が進行した網膜色素変性症の見え方"
emoji: "🙌"
type: "idea"
topics: [機械学習, 画像生成, 拡散モデル]
published: true
---
## はじめに

与太話です。ゼロから作るDeep Learning 5―生成モデル編を読んで突拍子もないことを思いついたのでメモします。

- [O'Reilly Japan - ゼロから作るDeep Learning ❺](https://www.oreilly.co.jp/books/9784814400591/)

あくまで一個人のメモです。この記事は医学的な情報を提供するものではありません。また、記事の内容は患者を代表するものではないのでご注意ください。

そして本題とは関係ありませんが、このシリーズはEPUB形式の電子書籍として販売されています。スクリーンリーダーで読み上げできるので助かっています。おそらく二年後にシリーズ第6弾が発売されるので楽しみです。

## 網膜色素変性症とは

人体をシステムに例えてみます。

- 脳→プロセッサー
- 視神経→データバス
- 網膜→イメージセンサー
- 眼球→レンズ

網膜色素変性症はイメージセンサー（網膜）が徐々に壊れて失明する病気です。

## 筆者について

生後から5、6歳頃までは視力に異常はなく裸眼で過ごしていました。その後は徐々に視力が低下し16歳の時点で網膜色素変性症と新段差荒れました。

診断された当初の症状はわずかな視野欠損のみでした。その後、さらに症状が進行し現在に至ります。この記事を投稿した時点の年齢は30歳です。

直近の定期診断（2024年4月に行った眼底検査）によると視覚障害の症状は網膜色素変性症に由来するものであり、緑内障など他の視力に関連する病気は認められませんでした。また、視覚障害を除き体に異常はありません。

## 網膜色素変性症の見え方

視界がまっ暗になると思われがちですが、間違いです。私の場合、自覚症状は以下のようなものです。

- 常にブラウン管テレビの砂嵐のような模様が見える。模様は静止画ではなく動画であり、常にチカチカ点滅している。
- まぶたを開けても閉じても砂嵐の見え方は変化しない。眼球を上下左右に動かすと砂嵐も動きに合わせて移動するように感じる。
- 砂嵐と同時に緑や紫の霧がかかったように感じることがある。色のついた霧は視界全体に広がっているので、眼球を動かしても霧の広がり方は変化しない。
- 就寝中まれに目が見えていた頃の夢を見る。このとき映像は鮮明でありノイズはない。

## ノイズの発生源

目が見えていた頃の映像を夢に見ることがあるので、プロセッサー（脳）に異常はないと考えて差し支えないはずです。また、過去の健康診断で脳に異常が見つかったことはないことを書き加えておきます。

次はデータバス（視神経）です。緑内障（視神経が圧迫されて視野が欠損する病気）の自覚症状を調べると、砂嵐のような模様が見えるという話は見つかりません。視神経も正常と判断して問題ないでしょう。

従って、ノイズの発生源は網膜と考えるのが妥当でしょう。

網膜色素変性症の一般的な症状には雷のような強い光が見える、というものがあるそうです。砂嵐とは違う気もしますが、ランダムに光が現れる状況は共通していると考えられます。

ここまでは網膜に異常があるという診断が正しいのかをエンジニアリング的な観点で確認しただけです。本題はここからです。

## 拡散モデル

画像合成で利用される「Denoising Diffusion Probabilistic Models（DDPM）」やそれに類似したモデルを拡散モデルとよぶそうです。単語の意味は次のとおりです。

- Denoising（デノイジング）：ノイズの除去
- Diffusion（拡散）：物質が均一に広がる現象
- Probabilistic（確率的）：確率を用いた手法

ここで注目するのは拡散過程です。拡散過程とはノイズを混ぜるステップです。

ニューラルネットワークが人間の脳を模倣することで柔軟さを獲得したのであれば、ニューラルネットワークを観察することで脳の構造に迫れるかもしれません。そこで気になるのがノイズの発生源です。

## 眼球にノイズジェネレーターが搭載されている？

音声や画像などの解像度を疑似的に向上させる手法としてディザリングがあります。これは大雑把に説明すれば元の信号にわずかなノイズを加える処理です。

あくまで想像ですが、人間の目にはノイズ生成細胞（仮）があるのかもしれません。症状の進行によって光や色を感じる細胞が徐々に機能しなくなるのであれば、視界は徐々に暗くなり最終的には完全な暗闇になるはずです。

しかし、目を開けても閉じても常に砂嵐がチカチカしているわけですから、ノイズ生成細胞がランダムな信号を脳に送信していると考えることができます。あるいは網膜色素変性症は正常な細胞がノイズ生成細胞に変化する病気と捉えることができるかもしれません。

人間の脳が扱うのはアナログ信号ですからダイナミックレンジは無限大です。しかし、ある面積に配置できる細胞の数には限度があるはずです。そこで、解像度を稼ぐためにセンサー細胞に混ざってノイズ生成細胞が配置されているかもしれません。

そして、眼球のノイズ生成細胞には別の役割があり、それは画像生成に使用する乱数の提供かもしれません。CPUはあくまで計算のみ行い、真の乱数は生成できません。人間の脳も乱数を生成する機能がなく、なにか空想の絵を思い浮かべる時、眼球からのノイズを利用しているのかもしれません。

## おわりに

特にオチはありません。与太話にお付き合いありがとうございました。
