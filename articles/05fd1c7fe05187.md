---
title: "（iOS 16）カスタム読み上げ音声を実装する"
emoji: "✨"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [iOS, macOS, , AudioUnit, 音声合成, 読み上げ]
published: false
---
# はじめに

- [Creating a custom speech synthesizer - Apple Developer](https://developer.apple.com/documentation/avfaudio/audio_engine/audio_units/creating_a_custom_speech_synthesizer?language=objc)

# 環境

記事の投稿にあたり、以下の環境で動作確認を行いました。

- macOS Ventura 13.4.1
- iOS 16.5.1
- Xcode 14.3.1 (14E300c)

# プロジェクトの作成

## 本体アプリの作成

1. Xcodeを起動し、メニューのFile→New→Projectを選びます。
2. プラットフォームはiOS、テンプレートはAppを選択します。
3. プロダクト名は適当で構いません。ここでは仮に「HelloSpeech」とします。
4. インターフェースはSwiftUI、言語はSwiftを選びます。Use Core DataとInclude TestsのチェックはOFFで構いません。
5. 念の為アプリのビルドと実行ができるか確認します。地球儀のアイコンと「Hello, World!」のテキストが表示されたら成功です。

## Audio Unit Extensionの作成

1. プラットフォームはiOS、テンプレートはAudio Unit Extensionを選びます。
2. プロダクト名は適当で構いません。今回は「Synth」とします。
3. Organization Nameを設定します。この値が音声一覧に表示されます。今回は「カスタムボイス」とします。
4. Audio Unit TypeとしてSpeech Synthesizerを選びます。Subtype CodeとManufacturer Codeは適当で構いません。今回は「demo」と設定します。
5. ユーザーインターフェースを指定します。初期値としてPresents User Interfaceが設定されていた場合はNo User Interfaceに変更します。
6. Finishボタンを押して完了です。

## ターゲットの作成

## 実機を使った動作確認

1. Xcodeのメニューを開き、Product→Scheme→Manage Schemesを選びます。
2. Autocreate Schemes Nowボタンを押してスキームを作成します。完了したらCloseボタンを押して画面を閉じてください。
3. Xcodeのメニューを開き、Product→Schemeを選びます。

設定アプリを開き、アクセシビリティを選びます。

- VoiceOver→読み上げ→声と進み、
- 読み上げコンテンツ→声→英語

### SSMLの内容

```xml
<speak>
	<prosody rate="159.99994%" volume="-1.0dB">ダブルタップして編集します。</prosody>
</speak>
```

# 参考資料

1. [Creating a custom speech synthesizer - Apple Developer](https://developer.apple.com/documentation/avfaudio/audio_engine/audio_units/creating_a_custom_speech_synthesizer?language=objc)
