---
title: "Cloudflare Workerså…¥é–€"
emoji: "ğŸ™†"
type: "tech"
topics: [Cloudflare JavaScript TypeScript V8]
published: false
---
## ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯Cloudflare Workersã®å…¥é–€è¨˜äº‹ã§ã™ã€‚

- ã€ŒCloudflare Workersã¯ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒ»ã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã ã‚ˆã€ã¨èª¬æ˜ã•ã‚Œã¦æ—¥æœ¬èªã§OKã¨æ„Ÿã˜ã¦ã„ã‚‹æ–¹
- AWSã®Lambdaã‚„GCPã®Cloud Runã¨ä¼¼ãŸã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã ã‚ã†ã¨èªè­˜ã•ã‚Œã¦ã„ã‚‹æ–¹
- ãã‚‚ãã‚‚Cloudflare WorkersãŒä½•è€…ãªã®ã‹çŸ¥ã‚‰ãªã„æ–¹

ä¸Šè¨˜ã«å½“ã¦ã¯ã¾ã‚‹æ–¹ã®ãŠå½¹ã«ç«‹ã¦ã‚‹ã¯ãšã§ã™ã€‚

ãªãŠè¨˜äº‹ã‚’èª­ã¿é€²ã‚ã‚‹ä¸Šã§å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€JavaScriptã‚ã‚‹ã„ã¯TypeScriptã®èª­ã¿æ›¸ããŒã§ãã‚‹ã¨ã‚¹ãƒ ãƒ¼ã‚ºã«ç†è§£ã§ãã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

## ç’°å¢ƒæ§‹ç¯‰

è¨˜äº‹ã‚’èª­ã¿é€²ã‚ã‚‹ãŸã‚ã«ã€ã¾ãšã¯ç’°å¢ƒæ§‹ç¯‰ã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚ã¨ã„ã£ã¦ã‚‚ã€æœ€æ–°ã®node.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã ã‘ã§ã™ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸã‚‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

```console
$ node --version
v19.6.0
```

**è£œè¶³äº‹é …**

- v16.13.0ã‚ˆã‚Šæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚è¨˜äº‹ã‚’èª­ã¿é€²ã‚ã¦ä¸å…·åˆã«é­é‡ã—ãŸã¨ãã¯node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
- Windowsã§ã®å‹•ä½œæ¤œè¨¼ã¯ã—ã¦ã„ã¾ã›ã‚“ã€‚ã“ã“ã‹ã‚‰å…ˆã®æ‰‹é †ã«ã¤ã„ã¦ã¯å•é¡Œãªãå‹•ä½œã™ã‚‹ã¯ãšã§ã™ãŒã€ã‚‚ã—ä¸å…·åˆã«é­é‡ã—ãŸå ´åˆã¯WSLãªã©ã®Linuxç’°å¢ƒã‚’åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚

## ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—

æ—©é€ŸCloudflare Workersã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ãªã‚“ã¨å®Œå…¨ç„¡æ–™ã§åˆ©ç”¨ã§ãã‚‹Freeãƒ—ãƒ©ãƒ³ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚å¤ªã£è…¹ã§ã™ã­ã€‚

ã‚‚ã¡ã‚ã‚“ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®ç™»éŒ²ã¯ä¸è¦ã§ã™ã€‚æ°—ã¥ã‹ãªã„é–“ã«èª²é‡‘ã•ã‚Œã¦ã‚¯ãƒ©ã‚¦ãƒ‰ç ´ç”£ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã”å®‰å¿ƒãã ã•ã„ã€‚

ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®Sign upã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚ãƒªãƒ³ã‚¯ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

- [Cloudflare WorkersÂ®](https://workers.cloudflare.com)

ä½™è«‡ã«ãªã‚Šã¾ã™ãŒã€Freeãƒ—ãƒ©ãƒ³ã¯æ€§èƒ½é¢ã§ã„ãã¤ã‹åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚ã‚‚ã—Cloudflare Workersã‚’æ°—ã«å…¥ã£ãŸã‚‰æœ‰æ–™ãƒ—ãƒ©ãƒ³ã‚’æ¤œè¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚æ€§èƒ½é¢ã®é•ã„ã¨æ–™é‡‘ä½“ç³»ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã«ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

- [Limits - Cloudflare Workers docs](https://developers.cloudflare.com/workers/platform/limits/#worker-limits)
- [Pricing - Cloudflare Workers docs](https://developers.cloudflare.com/workers/platform/pricing/)

## ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®š

ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ãŸã‚‰cloudflare.comã‚’é–‹ã„ã¦Loginã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚ãƒ­ã‚°ã‚¤ãƒ³ãŒæˆåŠŸã™ã‚‹ã¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

Cloudflare Workersã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«`https://ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå.ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³.workers.dev`ã‚’ç™ºè¡Œã—ã¦ãã‚Œã¾ã™ï¼›ã€‚ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯è‡ªç”±ã«è¨­å®šã§ãã¾ã™ã€‚

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã€ŒWorkersã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å…¥åŠ›ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚ãŠå¥½ã¿ã®ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚

ã“ã“ã‹ã‚‰å…ˆã¯ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã—ã¦`example`ã‚’è¨­å®šã—ãŸã‚‚ã®ã¨ä»®å®šã—ã¦èª¬æ˜ã‚’é€²ã‚ã¾ã™ã€‚

## wranglerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ç¶šã„ã¦wranglerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’è¡Œã„ã¾ã™ã€‚wranglerã¯Cloudflare Workersã‚’æ“ä½œã™ã‚‹ãŸã‚ã®CLIãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

ã‚‚ã¡ã‚ã‚“Cloudflare Workersã¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰æ“ä½œã§ãã¾ã™ã€‚ã—ã‹ã—ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®è¦‹ãŸç›®ã¯ä»Šå¾Œå¤‰æ›´ã•ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãã†ã™ã‚‹ã¨ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’è²¼ã‚Šä»˜ã‘ãŸèª¬æ˜ã§ã¯æ··ä¹±ãŒç”Ÿã˜ã‚‹æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚

ãã“ã§ã€wranglerã‚’åˆ©ç”¨ã—ã¦èª¬æ˜ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ä¸€åº¦ã‚³ãƒãƒ³ãƒ‰ã‚’è¦šãˆã‚Œã°ä½œæ¥­åŠ¹ç‡ã‚‚ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```console
$ npm install -g wrangler
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒçµ‚ã‚ã£ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯æˆåŠŸã§ã™ã€‚

```console
$ npx wrangler --version
 â›…ï¸ wrangler 2.14.0
```

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã ã‘ã§ã¯ä½¿ãˆã¾ã›ã‚“ã€‚wranglerã‚’ä½¿ã†ã«ã¯èªè¨¼ãŒå¿…è¦ã§ã™ã€‚

ã¾ãšã¯`npx wrangler login`ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚å®Ÿè¡Œä»¤ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚

```console
$ npx wrangler login
 â›…ï¸ wrangler 2.14.0
--------------------
Attempting to login via OAuth...
Opening a link in your default browser: https://dash.cloudflare.com/oauth2/auth?response_type=code&client_id=...
```

ä¸Šè¨˜ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¨åŒæ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶ãŒèµ·å‹•ã—ã¾ã™ã®ã§ã€Allowãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

èªè¨¼ãŒæˆåŠŸã™ã‚‹ã¨ã€ŒSuccessfully logged in.ã€ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```console
$ npx wrangler login
 â›…ï¸ wrangler 2.14.0
--------------------
Attempting to login via OAuth...
Opening a link in your default browser: https://dash.cloudflare.com/oauth2/auth?response_type=code&client_id=...
Successfully logged in.
```

## Hello, World!

Cloudflare Workersã‚’åˆ©ç”¨ã™ã‚‹æº–å‚™ã¯æ•´ã„ã¾ã—ãŸã€‚å®šç•ªã®ã€ŒHello, World!ã€ã‚’ã—ã¾ã—ã‚‡ã†ã€‚

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–

ã¾ãšã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–ã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚ã“ã“ã§ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨ã—ã¦`hello`ã‚’è¨­å®šã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```console
$ npx wrangler init hello
```

åˆæœŸåŒ–ã®éš›ã«ã„ãã¤ã‹è³ªå•ã•ã‚Œã¾ã™ã€‚ä»Šå›ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ç­”ãˆã¾ã—ãŸã€‚

- gitã§ç®¡ç†ã—ã¾ã™ã‹ï¼Ÿ â†’ no
- TypeScriptã‚’ä½¿ã„ã¾ã™ã‹ï¼Ÿ â†’ yes
- Vitestã®ãƒ†ã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ â†’ no

ä»Šå›ã¯ã‚µãƒ³ãƒ—ãƒ«ã¨ã„ã†ã“ã¨ã§gitã®ç®¡ç†ã¨ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ç”Ÿæˆã¯å¤–ã—ã¾ã—ãŸã€‚ã¾ãŸã€TypeScriptã¯å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚èª¬æ˜ã‚’é€²ã‚ã‚‹ä¸Šã§éƒ½åˆãŒè‰¯ã„ãŸã‚TypeScriptã‚’é¸ã‚“ã ã ã‘ã§ã™ã€‚

å‚è€ƒã¾ã§ã«å®Ÿè¡Œä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚åˆæœŸåŒ–ãŒæˆåŠŸã™ã‚‹ã¨`hello`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

```console
$ npx wrangler init hello
 â›…ï¸ wrangler 2.14.0
-------------------------------------------------------
Using npm as package manager.
âœ¨ Created hello/wrangler.toml
âœ” Would you like to use git to manage this Worker? â€¦ no
âœ” No package.json found. Would you like to create one? â€¦ yes
âœ¨ Created hello/package.json
âœ” Would you like to use TypeScript? â€¦ yes
âœ¨ Created hello/tsconfig.json
âœ” Would you like to create a Worker at hello/src/index.ts? â€º Fetch handler
âœ¨ Created hello/src/index.ts
âœ” Would you like us to write your first test with Vitest? â€¦ no
(â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚â ‚) â ‹ idealTree:hello: sill idealTree buildDeps
npm WARN deprecated rollup-plugin-inject@3.0.2: This package has been deprecated and is no longer maintained. Please use @rollup/plugin-inject.
npm WARN deprecated sourcemap-codec@1.4.8: Please use @jridgewell/sourcemap-codec instead

added 104 packages, and audited 105 packages in 20s

12 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
âœ¨ Installed @cloudflare/workers-types and typescript into devDependencies

To start developing your Worker, run `cd hello && npm start`
To publish your Worker to the Internet, run `npm run deploy`
```

### Workerã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ

ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚ãŠå¥½ã¿ã®ã‚¨ãƒ‡ã‚£ã‚¿ã§`src/index.ts`ã‚’é–‹ã„ã¦ãã ã•ã„ã€‚

è¨˜äº‹ã®åŸ·ç­†æ™‚ç‚¹ã§ã¯ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚

```ts
/**
 * Welcome to Cloudflare Workers! This is your first worker.
 *
 * - Run `wrangler dev src/index.ts` in your terminal to start a development server
 * - Open a browser tab at http://localhost:8787/ to see your worker in action
 * - Run `wrangler publish src/index.ts --name my-worker` to publish your worker
 *
 * Learn more at https://developers.cloudflare.com/workers/
 */

export interface Env {
  // Example binding to KV. Learn more at https://developers.cloudflare.com/workers/runtime-apis/kv/
  // MY_KV_NAMESPACE: KVNamespace;
  //
  // Example binding to Durable Object. Learn more at https://developers.cloudflare.com/workers/runtime-apis/durable-objects/
  // MY_DURABLE_OBJECT: DurableObjectNamespace;
  //
  // Example binding to R2. Learn more at https://developers.cloudflare.com/workers/runtime-apis/r2/
  // MY_BUCKET: R2Bucket;
  //
  // Example binding to a Service. Learn more at https://developers.cloudflare.com/workers/runtime-apis/service-bindings/
  // MY_SERVICE: Fetcher;
}

export default {
  async fetch(
    request: Request,
    env: Env,
    ctx: ExecutionContext
  ): Promise<Response> {
    return new Response("Hello World!");
  },
};
```

### ã‚³ãƒ¼ãƒ‰ã®è§£èª¬

ç”Ÿæˆã•ã‚ŒãŸ`src/index.ts`ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

ã¾ãšã€å†’é ­ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯Workerã®å®Ÿè¡Œæ–¹æ³•ã«ã¤ã„ã¦ã®ç°¡å˜ãªèª¬æ˜ã§ã™ã‹ã‚‰èª­ã¿é£›ã°ã—ã¦ãã ã•ã„ã€‚ã“ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯å‰Šé™¤ã—ã¦æ§‹ã„ã¾ã›ã‚“ã€‚

æ¬¡ã¯`Env`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®šç¾©ã§ã™ã€‚Cloudflareã¯Workersã®ä»–ã«ã‚‚æ§˜ã€…ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ãŠã‚Šã€ãã‚Œã‚‰ã¨é€£æºã™ã‚‹éš›ã«å¿…è¦ã«ãªã‚Šã¾ã™ã€‚ç™ºå±•çš„ãªå†…å®¹ã«ãªã‚‹ãŸã‚ã€ã²ã¨ã¾ãšèª­ã¿é£›ã°ã—ã¾ã—ã‚‡ã†ã€‚

æœ€å¾Œã¯é–¢æ•°å®šç¾©ã§ã™ã€‚ã“ã“ãŒæœ€ã‚‚é‡è¦ãªéƒ¨åˆ†ã§ã™ã€‚`async fetch`ã¨æ›¸ã‹ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ã«æ³¨ç›®ã—ã¦ãã ã•ã„ã€‚ã“ã‚ŒãŒWorkerã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚

### å‡¦ç†ã®æµã‚Œ

fetché–¢æ•°ã§è¡Œã‚ã‚Œã‚‹å‡¦ç†ã®æµã‚Œã‚’èª¬æ˜ã—ã¾ã™ã€‚

1. HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹
2. ä½•ã‚‰ã‹ã®å‡¦ç†ã‚’è¡Œã†
3. HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™

ä»¥ä¸Šã§ã™ã€‚

å¤§ã¾ã‹ã«è¨€ãˆã°ã€Workerã¯fetché–¢æ•°ã®å®Ÿè¡Œå˜ä½ã§ã™ã€‚Cloudflareã®ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒåˆ°ç€ã™ã‚‹ã¨WorkerãŒä½œæˆã•ã‚Œã¦ã€fetché–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚fetché–¢æ•°ã®å®Ÿè¡ŒãŒå®Œäº†ã™ã‚‹ã¨Workerã¯å‰Šé™¤ã•ã‚Œã¾ã™ã€‚

ãã—ã¦ã€Cloudflare Workersã¯Workerã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚è‡ªå‰ã§ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ã™ã‚‹ã“ã¨ãªãã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®å‡¦ç†ã‚’å®Ÿè£…ã§ãã‚‹ãŸã‚ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã¨ã‚ˆã°ã‚Œã¦ã„ã¾ã™ã€‚

### æ¨™æº–API

ã“ã“ã§æ”¹ã‚ã¦fetché–¢æ•°ã®å¼•æ•°ã¨æˆ»ã‚Šå€¤ã«æ³¨ç›®ã—ã¦ãã ã•ã„ã€‚Requestã¨ResponseãŒã‚ã‚Šã¾ã™ã€‚ã©ã¡ã‚‰ã‚‚JavaScriptã®æ¨™æº–APIã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚

- [Request - Web APIs - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Request)
- [Response - Web APIs - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Response)

ã¤ã¾ã‚Šã€æµã‚Œã¦ããŸãƒã‚¤ãƒŠãƒªã‚’è§£æã—ã¦HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŠ½å‡ºã—ãŸã‚Šã€HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®Content-Lengthã‚’è¨ˆç®—ã—ãŸã‚Šã™ã‚‹å¿…è¦ãŒãªã„ã®ã§ã™ã€‚ä¾¿åˆ©ã§ã™ã­ã€‚

ãŸã ã—ã€è£ã‚’è¿”ã›ã°HTTPã§ã¯ãªã„ç‹¬è‡ªã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ‰±ã†ã“ã¨ã¯ã§ãã¾ã›ã‚“ã—ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«è¿‘ã„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã›ã‚“ã€‚å°†æ¥çš„ã«Cloudflare Workersã®æ©Ÿèƒ½ãŒæ‹¡å¼µã•ã‚Œã‚‹å¯èƒ½æ€§ã¯ã‚¼ãƒ­ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€åŸºæœ¬ã¯HTTPã‚’æ‰±ã†ã‚µãƒ¼ãƒ“ã‚¹ã ã¨è€ƒãˆã¦ãã ã•ã„ã€‚

ãªãŠfetché–¢æ•°ã«ã¯ç¬¬3ã®å¼•æ•°`ctx: ExecutionContext`ãŒã‚ã‚Šã¾ã™ã€‚ã“ã¡ã‚‰ã‚‚`Env`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨åŒæ§˜ã«ç™ºå±•çš„ãªå†…å®¹ã«ãªã‚‹ãŸã‚ã€ä»Šå›ã¯èª¬æ˜ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚

### æ‰‹å…ƒã®ãƒã‚·ãƒ³ã§å‹•ä½œç¢ºèªã™ã‚‹

ãŠå¾…ãŸã›ã—ã¾ã—ãŸã€‚å‹•ä½œç¢ºèªã®æ™‚é–“ã§ã™ã€‚ã¾ãšã¯æ‰‹å…ƒã®ãƒã‚·ãƒ³ã§Workerã‚’å‹•ã‹ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```console
$ npx wrangler dev
```

ã“ã‚Œã§æº–å‚™å®Œäº†ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯`localhost:8787`ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å¾…ã¡å—ã‘ã¾ã™ã€‚

ãã‚Œã§ã¯curlã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ã’ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚ŒãŸã‚‰æˆåŠŸã§ã™ã€‚

```console
$ curl http://localhost:8787
Hello, World!
```

ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ç„¡äº‹ã«ã€ŒHello, World!ã€ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

ãªãŠã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«æ”¹è¡Œæ–‡å­—ã€Œ`\n`ã€ã‚’å«ã‚ã¦ã„ãªã„ãŸã‚ã€å®Ÿéš›ã«ã¯ã€ŒHello, World!$ ã€ã®ã‚ˆã†ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ–‡å­—ã€Œ`$`ã€ãŒç¶šã‘ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚æ°—ã«ãªã‚‹æ–¹ã¯`\n`ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

### ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã«å…¬é–‹ã™ã‚‹

ã•ãã€ãŠã‚‚ã—ã‚ã„ã®ã¯ã“ã“ã‹ã‚‰ã§ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Cloudflareã®ã‚µãƒ¼ãƒãƒ¼ä¸Šã§WorkerãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```console
$ npx wrangler publish
```

ã“ã‚Œã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã‹ã‚‰Workerã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«curlã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¦ãã ã•ã„ã€‚

```console
$ curl https://hello.example.workers.dev
Hello, World!
```

ç´ æ™´ã‚‰ã—ã„ï¼

## åˆ©ç”¨ä¾‹ã‚’è€ƒãˆã‚‹

### ãŠã¿ãã˜Worker

### cfãƒ—ãƒ­ãƒ‘ãƒ†ã‚£Worker

## è¡æ’ƒã®äº‹å®Ÿï¼ï¼Ÿã‚ãªãŸã®ã‚³ãƒ¼ãƒ‰ã¯ä¸–ç•Œãƒ‡ãƒ“ãƒ¥ãƒ¼ã—ã¦ã„ãŸ

## æ¬¡ã¯ã©ã†ã™ã‚‹ï¼Ÿ

## å‚è€ƒè³‡æ–™

1. [Building a To-Do List with Workers and KV - The Cloudflare Blog](https://blog.cloudflare.com/building-a-to-do-list-with-workers-and-kv/)
[Cloudflare Workers ã¨ KV ã§TodoListã‚¢ãƒ—ãƒªã‚’ä½œã‚‹](https://zenn.dev/kameoncloud/articles/7236a2c6ad35c0)
1. [Cloudflareã«Node.jsã®AsyncLocalStorageãŒã‚µãƒãƒ¼ãƒˆã•ã‚ŒãŸã®ã§è©¦ã—ã¦ã¿ãŸ - DevelopersIO](https://dev.classmethod.jp/articles/cloudflare-workers-asynclocalstorage/)
1. [Get started guide - Cloudflare Workers docs](https://developers.cloudflare.com/workers/get-started/guide/)
2. [How Workers works - Cloudflare Workers docs](https://developers.cloudflare.com/workers/learning/how-workers-works/)
3. [Request - Cloudflare Workers docs](https://developers.cloudflare.com/workers/runtime-apis/request/)
3. [Request - Web APIs - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Request)
4. [Cloudflare Global Network - Data Center Locations - Cloudflare](https://www.cloudflare.com/network/)
5. [IATA - Wikipedia](https://en.wikipedia.org/wiki/IATA_airport_code)
6. [Autonomous system - Wikipedia](https://en.wikipedia.org/wiki/Autonomous_system_(Internet))
- [Wrangler (command line) - Cloudflare Workers docs](https://developers.cloudflare.com/workers/wrangler/)
- [Install/Update Wrangler - Cloudflare Workers docs](https://developers.cloudflare.com/workers/wrangler/install-and-update/)
